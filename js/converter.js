/**
 * do not use this map directory. japaneseToHieroglyph(source, target) can handle properly.
 */
const HIEROGLYPHS = {
    "γ‚": "π“„Ώ", "γ„": "π“‡", "γ†": "π“…‚", "γ": "π“‡‹", "γ": "π“―",
    "γ‹": "π“Άπ“„Ώ", "γ": "π“Άπ“­", "γ": "π“Άπ“…‚", "γ‘": "π“Άπ“‡‹", "γ“": "π“Άπ“―",
    "γ•": "π“‹΄π“„Ώ", "γ—": "π“™", "γ™": "π“‹΄π“…‚", "γ›": "π“‹΄π“‡‹", "γ": "π“‹΄π“―",
    "γ": "π“‡¤π“„Ώ", "γ΅": "π“Ώ", "γ¤": "π“‡¤π“…‚", "γ¦": "π“‡¤π“‡‹", "γ¨": "π“‡¤π“―",
    "γ": "π“–π“„Ώ", "γ«": "π“–π“­", "γ¬": "π“–π“…‚", "γ­": "π“–π“‡‹", "γ®": "π“–π“―",
    "γ―": "π“‰”π“„Ώ", "γ²": "π“‰”π“­", "γµ": "π“†‘", "γΈ": "π“‰”π“‡‹", "γ»": "π“‰”π“―",
    "γΎ": "π“…“π“‚£", "γΏ": "π“…“π“­", "γ‚€": "π“…“π“…‚", "γ‚": "π“…“π“‡‹", "γ‚‚": "π“…“π“―",
    "γ‚„": "π“‡π“„Ώ", "γ‚†": "π“‡π“…‚", "γ‚": "π“‡π“―",
    "γ‚‰": "π“‚‹π“‚£", "γ‚": "π“‚‹π“­", "γ‚‹": "π“‚‹π“…‚", "γ‚": "π“‚‹π“‡‹", "γ‚": "π“‚‹π“―",
    "γ‚": "π“…‚π“‚£", "γ‚’": "π“―", "γ‚“": "π“–",

    "γ": "π“Όπ“„Ώ", "γ": "π“Όπ“­", "γ": "π“Όπ“…‚", "γ’": "π“Όπ“‡‹", "γ”": "π“Όπ“―",
    "γ–": "π“Όπ“―", "γ": "π“†“", "γ": "π“ƒπ“…‚", "γ": "π“ƒπ“‡‹", "γ": "π“ƒπ“―",
    "γ ": "π“‚§π“‚£", "γΆ": "π“†“", "γ¥": "π“ƒπ“…‚", "γ§": "π“‚§π“‡‹", "γ©": "π“‚§π“―",
    "γ°": "π“ƒ€π“„Ώ", "γ³": "π“ƒ€π“­", "γ¶": "π“ƒ€π“„Ώ", "γΉ": "π“ƒ€π“‡‹", "γΌ": "π“ƒ€π“―",
    "γ±": "π“π“„Ώ", "γ΄": "π“π“­", "γ·": "π“π“…‚", "γΊ": "π“π“‡‹", "γ½": "π“π“―",

    "γγ‚ƒ": "π“΅π“­π“„Ώ", "γγ‚…": "π“΅π“­π“…‚", "γγ‚‡": "π“΅π“­π“―",
    "γ—γ‚ƒ": "π“™π“„Ώ", "γ—γ‚…": "π“™π“…‚", "γ—γ‚‡": "π“™π“―",
    "γ΅γ‚ƒ": "π“Ώπ“„Ώ", "γ΅γ‚…": "π“Ώπ“…‚", "γ΅γ‚‡": "π“Ώπ“―",
    "γ«γ‚ƒ": "π“–π“­π“„Ώ", "γ«γ‚…": "π“–π“­π“…‚", "γ«γ‚‡": "π“–π“­π“―",
    "γ²γ‚ƒ": "π“‰”π“­π“„Ώ", "γ²γ‚…": "π“‰”π“­π“…‚", "γ²γ‚‡": "π“‰”π“­π“―",
    "γΏγ‚ƒ": "π“…“π“­π“„Ώ", "γΏγ‚…": "π“…“π“­π“…‚", "γΏγ‚‡": "π“…“π“­π“―",
    "γ‚γ‚ƒ": "π“‚‹π“­π“„Ώ", "γ‚γ‚…": "π“‚‹π“­π“…‚", "γ‚γ‚‡": "π“‚‹π“­π“―",

    "γγ‚ƒ": "π“Όπ“­π“…‚", "γγ‚…": "π“Όπ“­π“„Ώ", "γγ‚‡": "π“Όπ“­π“―",
    "γγ‚ƒ": "π“†“π“„Ώ", "γγ‚…": "π“†“π“…‚", "γγ‚‡": "π“†“π“―",
    "γ³γ‚ƒ": "π“ƒ€π“­π“„Ώ", "γ³γ‚…": "π“ƒ€π“­π“…‚", "γ³γ‚‡": "π“ƒ€π“­π“―",
    "γ΄γ‚ƒ": "π“π“­π“„Ώ", "γ΄γ‚…": "π“π“­π“…‚", "γ΄γ‚‡": "π“π“­π“―"
};

/**
 * do not use this map directory. hieroglyphToJapanese(source, target) can handle properly.
 */
const HIRAGANAS = {
    "π“„Ώ": "γ‚", "π“‡": "γ„", "π“…‚": "γ†", "π“‡‹": "γ", "π“―": "γ",
    "π“Άπ“„Ώ": "γ‹", "π“Άπ“­": "γ", "π“Άπ“…‚": "γ", "π“Άπ“‡‹": "γ‘", "π“Άπ“―": "γ“",
    "π“‹΄π“„Ώ": "γ•", "π“™": "γ—", "π“‹΄π“…‚": "γ™", "π“‹΄π“‡‹": "γ›", "π“‹΄π“―": "γ",
    "π“‡¤π“„Ώ": "γ", "π“Ώ": "γ΅", "π“‡¤π“…‚": "γ¤", "π“‡¤π“‡‹": "γ¦", "π“‡¤π“―": "γ¨",
    "π“–π“„Ώ": "γ", "π“–π“­": "γ«", "π“–π“…‚": "γ¬", "π“–π“‡‹": "γ­", "π“–π“―": "γ®",
    "π“‰”π“„Ώ": "γ―", "π“‰”π“­": "γ²", "π“†‘": "γµ", "π“‰”π“‡‹": "γΈ", "π“‰”π“―": "γ»",
    "π“…“π“‚£": "γΎ", "π“…“π“­": "γΏ", "π“…“π“…‚": "γ‚€", "π“…“π“‡‹": "γ‚", "π“…“π“―": "γ‚‚",
    "π“‡π“„Ώ": "γ‚„", "π“‡π“…‚": "γ‚†", "π“‡π“―": "γ‚",
    "π“‚‹π“‚£": "γ‚‰", "π“‚‹π“­": "γ‚", "π“‚‹π“…‚": "γ‚‹", "π“‚‹π“‡‹": "γ‚", "π“‚‹π“―": "γ‚",
    "π“…‚π“‚£": "γ‚", "π“―": "γ‚’", "π“–": "γ‚“",

    "π“Όπ“„Ώ": "γ", "π“Όπ“­": "γ", "π“Όπ“…‚": "γ", "π“Όπ“‡‹": "γ’", "π“Όπ“―": "γ”",
    "π“Όπ“―": "γ–", "π“†“": "γ", "π“ƒπ“…‚": "γ", "π“ƒπ“‡‹": "γ", "π“ƒπ“―": "γ",
    "π“‚§π“‚£": "γ ", "π“†“": "γΆ", "π“ƒπ“…‚": "γ¥", "π“‚§π“‡‹": "γ§", "π“‚§π“―": "γ©",
    "π“ƒ€π“„Ώ": "γ°", "π“ƒ€π“­": "γ³", "π“ƒ€π“„Ώ": "γ¶", "π“ƒ€π“‡‹": "γΉ", "π“ƒ€π“―": "γΌ",
    "π“π“„Ώ": "γ±", "π“π“­": "γ΄", "π“π“…‚": "γ·", "π“π“‡‹": "γΊ", "π“π“―": "γ½",

    "π“΅π“­π“„Ώ": "γγ‚ƒ", "π“΅π“­π“…‚": "γγ‚…", "π“΅π“­π“―": "γγ‚‡",
    "π“™π“„Ώ": "γ—γ‚ƒ", "π“™π“…‚": "γ—γ‚…", "π“™π“―": "γ—γ‚‡",
    "π“Ώπ“„Ώ": "γ΅γ‚ƒ", "π“Ώπ“…‚": "γ΅γ‚…", "π“Ώπ“―": "γ΅γ‚‡",
    "π“–π“­π“„Ώ": "γ«γ‚ƒ", "π“–π“­π“…‚": "γ«γ‚…", "π“–π“­π“―": "γ«γ‚‡",
    "π“‰”π“­π“„Ώ": "γ²γ‚ƒ", "π“‰”π“­π“…‚": "γ²γ‚…", "π“‰”π“­π“―": "γ²γ‚‡",
    "π“…“π“­π“„Ώ": "γΏγ‚ƒ", "π“…“π“­π“…‚": "γΏγ‚…", "π“…“π“­π“―": "γΏγ‚‡",
    "π“‚‹π“­π“„Ώ": "γ‚γ‚ƒ", "π“‚‹π“­π“…‚": "γ‚γ‚…", "π“‚‹π“­π“―": "γ‚γ‚‡",

    "π“Όπ“­π“…‚": "γγ‚ƒ", "π“Όπ“­π“„Ώ": "γγ‚…", "π“Όπ“­π“―": "γγ‚‡",
    "π“†“π“„Ώ": "γγ‚ƒ", "π“†“π“…‚": "γγ‚…", "π“†“π“―": "γγ‚‡",
    "π“ƒ€π“­π“„Ώ": "γ³γ‚ƒ", "π“ƒ€π“­π“…‚": "γ³γ‚…", "π“ƒ€π“­π“―": "γ³γ‚‡",
    "π“π“­π“„Ώ": "γ΄γ‚ƒ", "π“π“­π“…‚": "γ΄γ‚…", "π“π“­π“―": "γ΄γ‚‡"
};

function japaneseToHieroglyph(source, target) {
    let result = true;
    let converted = "";
    let i = 0;
    while (i < source.length) {
        let character = source[i];
        if (i + 1 < source.length) {
            const nextChar = source[i + 1];
            if (nextChar === "γ‚ƒ" || nextChar === "γ‚…" || nextChar === "γ‚‡") {
                character += nextChar;
                i++;
            }
        }
        console.log("handling character: " + character);
        if (HIEROGLYPHS[character]) {
            converted += HIEROGLYPHS[character] + " ";
        } else {
            result = false
        }
        i++;
    }
    if (converted.endsWith(" ")) {
        converted = converted.substring(0, converted.length - 1);
    }
    target.value = converted;
    return result;
}

/**
 *
 * @returns {boolean} returns true if string is null or "" otherwise false.
 */
String.prototype.isEmpty = function () {
    return !this[0]
};

if (!String.prototype.endsWith) {
    String.prototype.endsWith = function (searchString, position) {
        var subjectString = this.toString();
        if (typeof position !== 'number'
            || !isFinite(position)
            || Math.floor(position) !== position
            || position > subjectString.length) {
            position = subjectString.length;
        }
        position -= searchString.length;
        var lastIndex = subjectString.lastIndexOf(searchString, position);
        return lastIndex !== -1 && lastIndex === position;
    };
}

function hieroglyphToJapanese(source, target) {
    let result = true;
    let converted = "";

    source.split(" ").forEach(function (t) {
        let c = t;
        if (c.endsWith(" ")) {
            c = c.substring(0, c.length - 1);
        }
        if (c.isEmpty()) {
            return;
        }
        console.log("handling string: " + t);
        if (HIRAGANAS[c]) {
            result += HIRAGANAS[c];
        } else {
            result = false;
        }
    })
}
